import { registerBlockType } from '@wordpress/blocks';
import { InnerBlocks } from '@wordpress/block-editor';

import metadata from './block.json';
import Controls from './controls.jsx';

import './style.scss';

registerBlockType(metadata.name, {
	title: metadata.title,
	description: metadata.description,
	attributes: metadata.attributes,
	category: metadata.category,
	icon: {
		src: (
			<svg width="800" height="800" viewBox="0 0 94.294 94.294">
				<path d="m94.21 19.806-.597-2.911a4.065 4.065 0 0 0-4.771-3.168l-.465.09c-.574.109-1.224.237-1.898.422-.695.167-1.34.371-1.912.554l-.391.123-.135.045c-1.499.527-3 1.163-4.513 1.911a48.399 48.399 0 0 0-4.13 2.379 58.538 58.538 0 0 0-3.789 2.711 65.283 65.283 0 0 0-3.147 2.655h-7.819l-2.176-2.362a4.069 4.069 0 0 0-2.865-1.309 4.052 4.052 0 0 0-2.939 1.132l-2.639 2.539H0v56.029h77.196V33.895a50.922 50.922 0 0 1 2.465-2.455 44.442 44.442 0 0 1 2.726-2.309 36.445 36.445 0 0 1 2.849-1.97l.304-.178c.367-.216.734-.433 1.115-.623.05-.026.101-.052.152-.08.334-.185.681-.341 1.025-.502l.756-.331c.34-.14.68-.283 1.028-.393.063-.021.127-.044.19-.067.326-.122.662-.212.996-.306l.575-.164a4.059 4.059 0 0 0 2.833-4.711zM16.95 72.829h-4.472l.016-16.451-3.879 3.415-2.156-2.691 6.815-5.428h3.676v21.155zm28.347 0H30.508V69.72l5.311-5.369c1.572-1.609 2.6-2.729 3.082-3.35.483-.622.83-1.197 1.043-1.729.212-.53.318-1.08.318-1.65 0-.848-.234-1.479-.703-1.896-.468-.414-1.092-.621-1.873-.621a5.41 5.41 0 0 0-2.389.563c-.771.377-1.576.911-2.416 1.605l-2.431-2.879c1.042-.89 1.905-1.517 2.59-1.881a9.609 9.609 0 0 1 2.243-.848c.81-.196 1.716-.298 2.72-.298 1.321 0 2.489.241 3.501.724 1.014.483 1.8 1.159 2.359 2.026.559.869.838 1.862.838 2.981 0 .974-.17 1.889-.513 2.741-.343.854-.873 1.729-1.592 2.625-.719.897-1.984 2.179-3.798 3.835l-2.721 2.562v.202h9.218v3.763h.002zm22.197-1.411c-1.477 1.135-3.583 1.7-6.324 1.7-2.295 0-4.33-.381-6.105-1.143v-3.809c.82.415 1.722.755 2.705 1.016.986.26 1.959.39 2.924.39 1.476 0 2.566-.251 3.27-.753.705-.502 1.057-1.307 1.057-2.416 0-.993-.405-1.698-1.215-2.112-.811-.415-2.104-.622-3.879-.622H58.32v-3.431h1.635c1.641 0 2.839-.214 3.596-.642.758-.431 1.137-1.167 1.137-2.209 0-1.602-1.004-2.4-3.01-2.4-.695 0-1.401.115-2.121.347-.717.231-1.516.631-2.394 1.201l-2.069-3.083c1.928-1.389 4.229-2.084 6.901-2.084 2.19 0 3.919.445 5.188 1.332 1.268.888 1.902 2.123 1.902 3.704 0 1.321-.4 2.445-1.201 3.373-.801.925-1.925 1.562-3.371 1.909v.088c1.707.21 3 .729 3.877 1.555.877.825 1.316 1.937 1.316 3.335.002 2.037-.735 3.621-2.212 4.754zm20.651-50.53c-.61.195-1.205.459-1.803.697-.584.277-1.176.533-1.744.85-.58.289-1.138.626-1.699.953a39.728 39.728 0 0 0-3.221 2.223 48.389 48.389 0 0 0-3.004 2.543 57.006 57.006 0 0 0-5.408 5.78 64.707 64.707 0 0 0-2.412 3.146 55.61 55.61 0 0 0-1.123 1.619A34.49 34.49 0 0 0 66.71 40.3l-1.827 3.007-2.593-2.58-11.647-11.596 4.596-4.42 8.925 9.688c.167-.202.331-.41.499-.61a74.115 74.115 0 0 1 2.876-3.174 62.116 62.116 0 0 1 6.345-5.756 52.602 52.602 0 0 1 3.502-2.505 44.618 44.618 0 0 1 3.754-2.163 35.964 35.964 0 0 1 4.01-1.694c.697-.22 1.388-.454 2.102-.62.702-.198 1.428-.318 2.145-.461l.597 2.911c-.621.183-1.244.336-1.849.561z" />
			</svg>
		),
	},
	edit: EditorComponent,
	save: () => <InnerBlocks.Content />,
});

/**
 * Block component at wp-admin
 * @param {*} props Block's properties
 * @returns JSX
 */
export default function EditorComponent({ attributes, setAttributes }) {
	const randomComponentId = Math.floor(Math.random() * 10000);
	const { allowed_blocks } = attributes;

	return (
		<>
			{/* Editor controls */}
			<Controls attributes={attributes} setAttributes={setAttributes} />

			<section className={`big-numbers-carousel  big-numbers-carousel-${randomComponentId}`}>
				<div class="carousel-content-social">
					<InnerBlocks allowedBlocks={[...allowed_blocks]} />
				</div>
			</section>
		</>
	);
}
